
# make_cities_json.py
import json
import pandas as pd

# Read Excel
df = pd.read_excel('dataset.xlsx', engine='openpyxl')
df.columns = [str(c).strip() for c in df.columns]
cities = sorted({str(x).strip() for x in df['City'].dropna().unique()})

# Minimal known coordinates (extend as needed)
known = {
    "Hyderabad": (17.3850, 78.4867, "Telangana"),
    "Bengaluru": (12.9716, 77.5946, "Karnataka"),
    "Chennai": (13.0827, 80.2707, "Tamil Nadu"),
    "Mumbai": (19.0760, 72.8777, "Maharashtra"),
    "Pune": (18.5204, 73.8567, "Maharashtra"),
    "Ahmedabad": (23.0225, 72.5714, "Gujarat"),
    "Surat": (21.1702, 72.8311, "Gujarat"),
    "Jaipur": (26.9124, 75.7873, "Rajasthan"),
    "Kolkata": (22.5726, 88.3639, "West Bengal"),
    "Nashik": (20.0113, 73.7908, "Maharashtra"),
    "Coimbatore": (11.0168, 76.9558, "Tamil Nadu")
}

out = []
for city in cities:
    if city in known:
        lat, lon, state = known[city]
        out.append({"city": city, "lat": lat, "lng": lon, "admin_name": state})
    else:
        out.append({"city": city, "lat": None, "lng": None, "admin_name": None})

# Write to assets/in-cities.json
import os
os.makedirs('assets', exist_ok=True)
with open('assets/in-cities.json', 'w', encoding='utf-8') as f:
    json.dump(out, f, ensure_ascii=False, indent=2)

print(f"Wrote {len(out)} cities to assets/in-cities.json; {sum(1 for c in out if c['lat'] is None)} need coordinates.")
